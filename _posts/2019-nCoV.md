---
layout: post
title:  "How to model the progression of the Chinese coronavirus"
date: '2019-12-25 21:30:00'
---

## Introduction
December the 31st the Chinese health autorities informed about a case of pneumonia of unknown origin. Three days after, another 43 cases were reported to the WHO. Twelve days later the Chinese goverment had found the pneumonias were caused by a new type of coronavirus (link) and traced back the origin of the disease to a with a seafood market in [Wuhan]().
One month later 170 persons have died and there are 7818 confirmed cases plus 12167 suspected cases among 18 countries.
Today in this post I am going to explain how to use numerical simulations to study and predict outbreaks like this one.
{: style="text-align: justify"}

## The infection.
So far the amount of known information about the virus is very limited but there are some facts that seem to be clear.

1st. The causal agent is a coronavirus: Coronaviruses are viruses that are transmited from animals to humans. For this jump between species to happen, the viruses must gain the ability to infect new species through mutations in their genetic material. 
2nd. During these 30 days the virus has propagated following and exponential progression:

[!progression]()

Looking at the data, it seems that it would be possible to fit it with a function like:

$$\[y=1+a·e^{b·x}\]$$

To do that we first need to make a guess for the staring values of a and b. Something that we can du applying logs to the equation in order to transform it into a linear equation:

log(y-1)=log(a)+bx

In this way we can estimate log(a) and b:

linear<-lm(log(df$Infected-1)~df$Day)
start <- list(a=exp(coef(linear)[1]), b=coef(linear)[2])

Now that we have the coeficients for the linear fit we can used them as starting point to estimate the coeficients of the exponential fit:

mod <- nls(Infected ~ a*(exp(b*Day)), data = df, start = start)

We extracts the coeficients and to make predictions:

a-The model predicts that tomorrow 31st of January there will be 11437 infected. 
b-According to the model every 24 hours the number of infections multiplies by 1.41

## Modeling future events by numerical simulations.

So far we have created a very basic model. It does not take into account a lot of parameters (e.g. natural immunity, population density, number of deaths, etc), so we are going to create a better way to forecast the evolution of the infection but also to let us make some causal/conterfactual inferences.

A good way to do it is using numerical models.
